<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025 입학생을 위한 경기여고 과목 선택 가이드</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #FDFBF5;
            color: #4A4A4A;
        }
        .active-filter {
            background-color: #587D71 !important;
            color: #FFFFFF !important;
            font-weight: 700;
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .filter-btn {
            transition: all 0.3s ease;
        }
        .card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.07), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .section-title::after {
            content: '';
            display: block;
            width: 50px;
            height: 3px;
            background-color: #587D71;
            margin-top: 12px;
        }
        .domain-area-container, .grouped-area-container {
            background-color: #F8F6F0;
            border: 1px solid #E5E1D4;
            border-radius: 1rem;
            padding: 1.5rem;
        }
        .subject-type-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        .notice-box {
            margin-bottom: 1.5rem;
            background-color: #FFFBEB;
            border-left: 4px solid #FBBF24;
            color: #92400E;
            padding: 1rem;
            border-radius: 0 0.5rem 0.5rem 0;
        }
        .modal {
            transition: opacity 0.3s ease;
        }
        .timetable-checkbox {
            display: none; /* Hide the default checkbox */
        }
        .custom-checkbox {
            width: 1.25rem;
            height: 1.25rem;
            border: 2px solid #cbd5e1;
            border-radius: 0.25rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            font-size: 0.75rem;
            font-weight: bold;
            color: transparent;
            flex-shrink: 0;
        }
        .timetable-checkbox:checked + .custom-checkbox {
            background-color: #6b7280;
            border-color: #6b7280;
            color: white;
        }
        /* Group-specific colors */
        .timetable-checkbox.kme-group:checked + .custom-checkbox {
            background-color: #3b82f6; /* Blue */
            border-color: #3b82f6;
        }
        .timetable-checkbox.tech-group:checked + .custom-checkbox {
            background-color: #10b981; /* Green */
            border-color: #10b981;
        }
        .timetable-checkbox.art-group:checked + .custom-checkbox {
            background-color: #8b5cf6; /* Purple */
            border-color: #8b5cf6;
        }

        .timetable-checkbox:disabled + .custom-checkbox {
            background-color: #f3f4f6;
            border-color: #d1d5db;
        }
        .timetable-checkbox:disabled ~ span {
             cursor: not-allowed;
             color: #9ca3af;
        }
        th, td {
            text-align: center;
            padding: 0.75rem;
            vertical-align: middle;
        }
    </style>
</head>
<body class="bg-stone-50">

    <div class="container mx-auto p-4 md:p-8">
        
        <header class="text-center my-8 md:my-16">
            <h1 class="text-3xl md:text-5xl font-bold text-[#4B5D55]">2025 입학생을 위한 경기여고 과목 선택 가이드</h1>
            <p class="mt-4 text-lg md:text-xl text-gray-600">나의 미래를 디자인하는 첫걸음, 나만의 교육과정 꾸리기</p>
        </header>

        <main>
            <section id="intro" class="mb-16">
                <div class="bg-white p-8 rounded-2xl shadow-sm">
                    <h2 class="text-2xl font-bold mb-6 section-title text-[#4B5D55]">나만의 교육과정 설계하기</h2>
                    <div class="space-y-6 text-gray-700 leading-relaxed">
                        <p>고교학점제는 정해진 시간표를 따르는 수동적 학습에서 벗어나, 학생이 직접 진로와 적성에 맞춰 과목을 선택하고 교육과정을 설계하는 자기주도적 학습 여정입니다.</p>
                        <p>대학은 성적표를 통해 단순히 점수를 확인하는 것이 아니라, '어떤 과목을', '왜', 그리고 '어떻게' 이수했는지를 보며 여러분의 지적 호기심, 전공에 대한 열정, 탐구 역량을 파악합니다. 따라서 여러분의 과목 선택 하나하나가 모여 '나'라는 사람의 학업 스토리를 만들게 됩니다.</p>
                        <div class="bg-[#F8F6F0] p-6 rounded-lg border border-gray-200">
                             <h3 class="font-bold text-lg mb-2 text-[#587D71]">2022 개정 교육과정의 과목 분류</h3>
                             <ul class="list-disc list-inside space-y-2">
                                 <li><span class="font-semibold">공통과목:</span> 1학년 때 배우는 기초 소양 함양을 위한 필수 과목입니다.</li>
                                 <li><span class="font-semibold">일반선택:</span> 교과별 학문의 기본을 이해하는 과목입니다.</li>
                                 <li><span class="font-semibold">진로선택:</span> 진로 방향에 맞춰 특정 분야를 깊이 있게 탐구하는 과목입니다.</li>
                                 <li><span class="font-semibold">융합선택:</span> 학문 간 경계를 넘어 통합적 사고력을 기르는 새로운 과목입니다.</li>
                             </ul>
                        </div>
                    </div>
                </div>
            </section>

            <section id="navigator" class="mb-16">
                <h2 class="text-2xl font-bold mb-8 text-center section-title mx-auto text-[#4B5D55]">과목별 네비게이터</h2>
                <div id="filter-container" class="flex flex-wrap justify-center gap-2 md:gap-4 mb-8">
                    <button class="filter-btn bg-white px-4 py-2 rounded-full shadow-sm font-semibold text-gray-700 hover:bg-gray-100" data-filter="전체">전체보기</button>
                    <button class="filter-btn bg-white px-4 py-2 rounded-full shadow-sm font-semibold text-gray-700 hover:bg-gray-100" data-filter="국어">국어</button>
                    <button class="filter-btn bg-white px-4 py-2 rounded-full shadow-sm font-semibold text-gray-700 hover:bg-gray-100" data-filter="수학">수학</button>
                    <button class="filter-btn bg-white px-4 py-2 rounded-full shadow-sm font-semibold text-gray-700 hover:bg-gray-100" data-filter="영어">영어</button>
                    <button class="filter-btn bg-white px-4 py-2 rounded-full shadow-sm font-semibold text-gray-700 hover:bg-gray-100" data-filter="사회">사회</button>
                    <button class="filter-btn bg-white px-4 py-2 rounded-full shadow-sm font-semibold text-gray-700 hover:bg-gray-100" data-filter="과학">과학</button>
                    <button class="filter-btn bg-white px-4 py-2 rounded-full shadow-sm font-semibold text-gray-700 hover:bg-gray-100" data-filter="기술·가정/정보">기술·가정/정보</button>
                    <button class="filter-btn bg-white px-4 py-2 rounded-full shadow-sm font-semibold text-gray-700 hover:bg-gray-100" data-filter="제2외국어/한문">제2외국어</button>
                    <button class="filter-btn bg-white px-4 py-2 rounded-full shadow-sm font-semibold text-gray-700 hover:bg-gray-100" data-filter="예술">예술</button>
                    <button class="filter-btn bg-white px-4 py-2 rounded-full shadow-sm font-semibold text-gray-700 hover:bg-gray-100" data-filter="체육">체육</button>
                </div>

                <div id="course-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
                <div id="social-studies-container" class="hidden"></div>
                <div id="science-container" class="hidden"></div>
                <div id="grouped-courses-container" class="hidden"></div>
            </section>
            
            <section id="timetable-builder" class="mb-16">
                 <div class="text-center mb-8">
                    <h2 class="text-2xl font-bold section-title mx-auto text-[#4B5D55] inline-block">나만의 선택과목 로드맵 만들어보기</h2>
                    <div class="mt-4 text-sm text-center bg-amber-100 border-l-4 border-amber-500 text-amber-800 p-4 rounded-r-lg inline-block">
                        <p>이것은 가상의 수강신청 연습 페이지입니다. 실제 선택과목 수강신청은 2학년 1학기, 2학년 2학기를 대상으로 하며, 리로스쿨>교육과정>수강신청 페이지에서 합니다.</p>
                        <p class="mt-1"><strong>(1차 수강신청 기간: 25.7.7~25.7.10)</strong></p>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div id="validation-panel" class="lg:col-span-3 p-6 bg-white rounded-2xl shadow-sm self-start">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold text-[#4B5D55]">과목 선택 전 체크! [교과(군)별 필수이수학점 안내]</h3>
                            <a href="#" id="open-curriculum-pdf" class="text-sm font-semibold text-blue-600 hover:underline">우리학교 교육과정 편제표 보기 click</a>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm border-collapse">
                                <thead class="bg-gray-100">
                                    <tr>
                                        <th class="border p-2">교과(군)</th>
                                        <th class="border p-2">필수이수학점</th>
                                        <th class="border p-2">총족여부<br><span class="text-xs font-normal">(학교지정<br>과목으로 이수)</span></th>
                                        <th class="border p-2">비고</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white">
                                    <tr>
                                        <td class="border p-2 font-semibold">국어</td>
                                        <td class="border p-2">8</td>
                                        <td class="border p-2 text-green-600 font-bold">O</td>
                                        <td class="border p-2 text-left align-middle" rowspan="3"><strong class="text-blue-600 font-bold text-lg">8과목 이하(25학점 이내) 선택</strong><br><span class="text-xs">(국어/수학/영어(군)은 3년간 81학점을 초과할 수 없음, 학교지정과목으로 56학점 이수)</span></td>
                                    </tr>
                                    <tr>
                                        <td class="border p-2 font-semibold">수학</td>
                                        <td class="border p-2">8</td>
                                        <td class="border p-2 text-green-600 font-bold">O</td>
                                    </tr>
                                    <tr>
                                        <td class="border p-2 font-semibold">영어</td>
                                        <td class="border p-2">8</td>
                                        <td class="border p-2 text-green-600 font-bold">O</td>
                                    </tr>
                                    <tr>
                                        <td class="border p-2 font-semibold">한국사/사회/과학</td>
                                        <td class="border p-2">6/8/10</td>
                                        <td class="border p-2 text-green-600 font-bold">O</td>
                                        <td class="border p-2 text-left">2~3학년 동안 과목 선택 수에 제한 없음.</td>
                                    </tr>
                                     <tr>
                                        <td class="border p-2 font-semibold">체육</td>
                                        <td class="border p-2">10</td>
                                        <td class="border p-2 text-green-600 font-bold">O</td>
                                        <td class="border p-2 text-left">학교지정과목으로 매학기 개설됨</td>
                                    </tr>
                                    <tr>
                                        <td class="border p-2 font-semibold">기술가정/정보/제2외국어</td>
                                        <td class="border p-2">16</td>
                                        <td class="border p-2 text-red-600 font-bold">X</td>
                                        <td class="border p-2 text-left"><strong class="text-lg text-green-600 font-bold">4과목 이상</strong>(11학점 이상) 이수해야 함.<br>1학년에서 논술(2)+기가/정보(3)=5학점 취득</td>
                                    </tr>
                                     <tr>
                                        <td class="border p-2 font-semibold">예술</td>
                                        <td class="border p-2">10</td>
                                        <td class="border p-2 text-red-600 font-bold">X</td>
                                        <td class="border p-2 text-left"><strong class="text-lg text-purple-600 font-bold">2과목 이상</strong>(6학점 이상) 이수해야 함.<br>1학년에서 미술(2)+음악(2)=4학점 취득</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div id="selection-panel" class="lg:col-span-3 grid grid-cols-1 md:grid-cols-2 gap-6 mt-8">
                        <!-- Timetable selection UI will be generated here -->
                    </div>
                </div>
            </section>
            
            <section id="conclusion" class="text-center">
                 <div class="bg-white p-8 rounded-2xl shadow-sm">
                    <h2 class="text-2xl font-bold mb-6 section-title mx-auto text-[#4B5D55]">여러분의 빛나는 미래를 응원하며</h2>
                    <div class="space-y-6 text-gray-700 max-w-3xl mx-auto leading-relaxed">
                        <p>과목선택 가이드를 경직된 규칙이 아닌, 자신만의 길을 개척하는 데 필요한 나만의 나침반으로 활용하세요. 끊임없이 자신에게 질문하고, 선생님과 상담하며 가장 '나다운' 교육과정을 만들어가기를 바랍니다. 과목 선택이라는 기회를 통해, 자신만의 고유한 색깔로 빛나는 미래를 그려나가기를 진심으로 응원합니다.</p>
                        <p class="mt-8 font-bold">- 삶이라는 바다를 힘차게 항해할 학생들의 등대가 되고싶은, 경기여고 선생님 일동 -</p>
                    </div>
                </div>
            </section>
        </main>

        <footer class="text-center py-12 mt-8 text-gray-500">
            <p>&copy; 2025 Kyunggi Girls' High School. All Rights Reserved.</p>
        </footer>
    </div>
    
    <!-- Course Modal -->
    <div id="course-modal" class="modal hidden fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center p-4 border-b">
                <h3 id="modal-title" class="text-xl font-bold text-gray-800"></h3>
                <button id="close-course-modal-btn" class="text-gray-500 hover:text-gray-800 text-3xl">&times;</button>
            </div>
            <div id="modal-content" class="flex-grow p-2 md:p-4 overflow-y-auto">
                <!-- Image will be injected here -->
            </div>
        </div>
    </div>
    
    <!-- PDF Viewer Modal -->
     <div id="pdf-viewer-modal" class="modal hidden fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-2xl w-full max-w-4xl h-[90vh] flex flex-col">
            <div class="flex justify-between items-center p-4 border-b">
                <h3 class="text-xl font-bold text-gray-800">교육과정 편제표</h3>
                <button id="close-pdf-modal-btn" class="text-gray-500 hover:text-gray-800 text-3xl">&times;</button>
            </div>
            <div class="flex-grow p-2 overflow-hidden">
                <iframe id="pdf-iframe" src="" class="w-full h-full" frameborder="0"></iframe>
            </div>
        </div>
    </div>


    <script>
    document.addEventListener('DOMContentLoaded', () => {
        
        // --- Data Definitions ---
        const originalCourses = {
            '국어': [
                { name: '주제 탐구 독서', type: '진로선택', grade: '2-1' },
                { name: '문학과 영상', type: '진로선택', grade: '2-2' },
                { name: '독서 토론과 글쓰기', type: '융합선택', grade: '3-1' },
                { name: '매체 의사소통', type: '융합선택', grade: '3-2' },
                { name: '언어생활 탐구', type: '융합선택', grade: '3-2' },
                { name: '화법과 언어', type: '일반선택', grade: '2-1' }, 
                { name: '독서와 작문', type: '일반선택', grade: '2-2' }, 
                { name: '문학', type: '일반선택', grade: '1-1' }, 
            ],
            '수학': [
                { name: '기하', type: '진로선택', grade: '2-1' },
                { name: '인공지능 수학', type: '진로선택', grade: '2-2' },
                { name: '미적분Ⅱ', type: '융합선택', grade: '3-1' },
                { name: '수학과제 탐구', type: '융합선택', grade: '3-1' },
                { name: '수학과 문화', type: '융합선택', grade: '3-2' },
                { name: '실용 통계', type: '융합선택', grade: '3-2' },
                { name: '확률과 통계', type: '일반선택', grade: '2-2' },
            ],
            '영어': [
                { name: '세계 문화와 영어', type: '융합선택', grade: '2-1' },
                { name: '영미 문학 읽기', type: '진로선택', grade: '2-2' },
                { name: '심화 영어', type: '진로선택', grade: '3-1' },
                { name: '심화 영어 독해와 작문', type: '진로선택', grade: '3-2' },
                { name: '미디어 영어', type: '융합선택', grade: '3-2' },
                { name: '영어 독해와 작문', type: '일반선택', grade: '2-1' },
            ],
            '사회': {
                '지리': [
                    { name: '통합사회', type: '공통과목', grade: '1학년' },
                    { name: '세계시민과 지리', type: '일반선택', grade: '2-1' },
                    { name: '기후변화와 지속가능한 세계', type: '융합선택', grade: '2-2' },
                    { name: '한국지리 탐구', type: '진로선택', grade: '3-1' },
                    { name: '도시의 미래 탐구', type: '융합선택', grade: '3-2' },
                    { name: '여행지리', type: '융합선택', grade: '3-2' },
                ],
                '일반사회': [
                    { name: '금융과 경제생활', type: '융합선택', grade: '2-1' },
                    { name: '법과 사회', type: '진로선택', grade: '2-1' },
                    { name: '사회와 문화', type: '일반선택', grade: '2-2' },
                    { name: '정치', type: '진로선택', grade: '2-2' },
                    { name: '경제', type: '진로선택', grade: '3-1' },
                    { name: '사회문제 탐구', type: '융합선택', grade: '3-1' },
                    { name: '국제 관계의 이해', type: '융합선택', grade: '3-2' },
                ],
                '역사': [
                    { name: '한국사', type: '공통과목', grade: '1학년' },
                    { name: '동아시아 역사 기행', type: '진로선택', grade: '2-1' },
                    { name: '세계사', type: '일반선택', grade: '2-2' },
                    { name: '역사로 탐구하는 현대 세계', type: '융합선택', grade: '3-1' },
                ],
                '윤리': [
                    { name: '현대사회와 윤리', type: '일반선택', grade: '2-1' },
                    { name: '윤리문제 탐구', type: '융합선택', grade: '2-2' },
                    { name: '윤리와 사상', type: '진로선택', grade: '3-1' },
                    { name: '인문학과 윤리', type: '진로선택', grade: '3-2' },
                ]
            },
            '과학': {
                '물리학': [
                    { name: '통합과학', type: '공통과목', grade: '1학년' },
                    { name: '과학탐구실험', type: '공통과목', grade: '1학년'},
                    { name: '물리학', type: '일반선택', grade: '2-1' },
                    { name: '역학과 에너지', type: '진로선택', grade: '2-2' },
                    { name: '전자기와 양자', type: '진로선택', grade: '3-1' },
                ],
                '화학': [
                    { name: '화학', type: '일반선택', grade: '2-1' },
                    { name: '물질과 에너지', type: '진로선택', grade: '2-2' },
                    { name: '화학 반응의 세계', type: '진로선택', grade: '3-1'},
                ],
                '생명과학': [
                    { name: '세포와 물질대사', type: '진로선택', grade: '2-1'},
                    { name: '생명과학', type: '일반선택', grade: '2-2' },
                    { name: '생물의 유전', type: '진로선택', grade: '3-1'},
                ],
                '지구과학': [
                    { name: '지구과학', type: '일반선택', grade: '2-1' },
                    { name: '지구시스템과학', type: '진로선택', grade: '2-2' },
                    { name: '행성우주과학', type: '진로선택', grade: '3-1' },
                ],
                '융합': [
                     { name: '융합과학 탐구', type: '융합선택', grade: '2-2'},
                     { name: '기후변화와 환경생태', type: '융합선택', grade: '3-1'},
                     { name: '과학의 역사와 문화', type: '융합선택', grade: '3-2'},
                ]
            },
            '기술·가정/정보': {
                '기술가정 계열': [
                    { name: '생활과학 탐구', type: '진로선택', grade: '2-1' },
                    { name: '아동발달과 부모', type: '융합선택', grade: '2-2' },
                    { name: '지식 재산 일반', type: '융합선택', grade: '3-1' },
                    { name: '창의 공학 설계', type: '융합선택', grade: '3-2' },
                ],
                '정보 계열': [
                    { name: '데이터 과학', type: '진로선택', grade: '2-1' },
                    { name: '정보과학(특목)', type: '진로선택', grade: '2-2', description: "<특목고 개설과목>컴퓨터 과학의 기본 개념과 원리 및 기술을 바탕으로 창의적이고 효율적으로 다양한 분야의 문제를 해결하는 역량을 기르는 과목이다." },
                    { name: '인공지능 기초', type: '진로선택', grade: '3-1' },
                    { name: '소프트웨어와 생활', type: '융합선택', grade: '3-2' },
                ]
            },
            '제2외국어/한문': {
                '스페인어': [
                    { name: '스페인어', type: '일반선택', grade: '2-1' },
                    { name: '스페인어 회화', type: '진로선택', grade: '2-2' },
                    { name: '스페인어권 문화', type: '융합선택', grade: '3-1' },
                    { name: '심화 스페인어', type: '진로선택', grade: '3-2' },
                ],
                '일본어': [
                    { name: '일본어', type: '일반선택', grade: '2-1' },
                    { name: '일본어 회화', type: '진로선택', grade: '2-2' },
                    { name: '일본 문화', type: '융합선택', grade: '3-1' },
                    { name: '심화 일본어', type: '진로선택', grade: '3-2' },
                ]
            },
            '예술': {
                '음악': [
                    { name: '음악 연주와 창작', type: '진로선택', grade: '2-1' },
                    { name: '음악 감상과 비평', type: '진로선택', grade: '2-2' },
                    { name: '음악과 미디어', type: '융합선택', grade: '3-1' },
                    { name: '음악콘텐츠 제작', type: '진로선택', grade: '3-2' },
                ],
                '미술': [
                    { name: '미술 창작', type: '진로선택', grade: '2-1' },
                    { name: '미술 감상과 비평', type: '진로선택', grade: '2-2' },
                    { name: '미술과 매체', type: '융합선택', grade: '3-1' },
                    { name: '조형', type: '진로선택', grade: '3-2' },
                ]
            },
            '체육': [
                { name: '체육1', type: '일반선택', grade: '1-1'},
                { name: '체육2', type: '일반선택', grade: '1-2'},
                { name: '스포츠 생활 1', type: '융합선택', grade: '2-1'},
                { name: '스포츠 생활 2', type: '융합선택', grade: '2-2'},
                { name: '스포츠 문화', type: '진로선택', grade: '3-1'},
                { name: '스포츠 과학', type: '진로선택', grade: '3-2'}
            ]
        };
        const timetableData = {
            '2-1': {
                limit: 5,
                courses: {
                    '국어': [{ name: '주제 탐구 독서', id: '21_kor_1', group: '국수영' }],
                    '수학': [{ name: '기하', id: '21_math_1', group: '국수영' }],
                    '영어': [{ name: '세계 문화와 영어', id: '21_eng_1', group: '국수영'}],
                    '사회': [
                        { name: '세계시민과 지리', id: '21_soc_1', group: '사과' },
                        { name: '현대사회와 윤리', id: '21_soc_2', group: '사과' },
                        { name: '법과 사회', id: '21_soc_3', group: '사과' },
                        { name: '동아시아 역사 기행', id: '21_soc_4', group: '사과' },
                        { name: '금융과 경제생활', id: '21_soc_5', group: '사과' },
                    ],
                    '과학': [
                        { name: '물리학', id: '21_sci_1', group: '사과' },
                        { name: '화학', id: '21_sci_2', group: '사과' },
                        { name: '지구과학', id: '21_sci_3', group: '사과' },
                        { name: '세포와 물질대사', id: '21_sci_4', group: '사과' },
                    ],
                    '기술·가정/정보': [
                        { name: '생활과학 탐구', id: '21_tech_1', group: '기정제' },
                        { name: '데이터 과학', id: '21_tech_2', group: '기정제' },
                    ],
                    '제2외국어/한문': [
                        { name: '스페인어', id: '21_lang_1', group: '기정제' },
                        { name: '일본어', id: '21_lang_2', group: '기정제' },
                    ],
                    '예술': [
                        { name: '음악 연주와 창작', id: '21_art_1', group: '예술' },
                        { name: '미술 창작', id: '21_art_2', group: '예술' },
                    ]
                }
            },
            '2-2': {
                limit: 5,
                courses: {
                    '국어': [{ name: '문학과 영상', id: '22_kor_1', group: '국수영' }],
                    '수학': [{ name: '인공지능 수학', id: '22_math_1', group: '국수영' }],
                    '영어': [{ name: '영미 문학 읽기', id: '22_eng_1', group: '국수영' }],
                    '사회': [
                        { name: '사회와 문화', id: '22_soc_1', group: '사과' },
                        { name: '세계사', id: '22_soc_2', group: '사과' },
                        { name: '정치', id: '22_soc_3', group: '사과' },
                        { name: '윤리문제 탐구', id: '22_soc_4', group: '사과' },
                        { name: '기후변화와 지속가능한 세계', id: '22_soc_5', group: '사과' },
                    ],
                    '과학': [
                        { name: '생명과학', id: '22_sci_1', group: '사과' },
                        { name: '역학과 에너지', id: '22_sci_2', group: '사과' },
                        { name: '물질과 에너지', id: '22_sci_3', group: '사과' },
                        { name: '지구시스템과학', id: '22_sci_4', group: '사과' },
                        { name: '융합과학 탐구', id: '22_sci_5', group: '사과' },
                    ],
                     '기술·가정/정보': [
                        { name: '아동발달과 부모', id: '22_tech_1', group: '기정제' },
                        { name: '정보과학(특목)', id: '22_tech_2', group: '기정제' },
                    ],
                    '제2외국어/한문': [
                        { name: '스페인어 회화', id: '22_lang_1', group: '기정제' },
                        { name: '일본어 회화', id: '22_lang_2', group: '기정제' },
                    ],
                    '예술': [
                         { name: '음악 감상과 비평', id: '22_art_1', group: '예술' },
                         { name: '미술 감상과 비평', id: '22_art_2', group: '예술' },
                    ]
                }
            },
            '3-1': {
                limit: 6,
                courses: {
                    '국어': [{ name: '독서 토론과 글쓰기', id: '31_kor_1', group: '국수영' }],
                    '수학': [
                        { name: '미적분Ⅱ', id: '31_math_1', group: '국수영' },
                        { name: '수학과제 탐구', id: '31_math_2', group: '국수영' },
                    ],
                    '영어': [{ name: '심화 영어', id: '31_eng_1', group: '국수영' }],
                     '사회': [
                        { name: '윤리와 사상', id: '31_soc_1', group: '사과' },
                        { name: '경제', id: '31_soc_2', group: '사과' },
                        { name: '한국지리 탐구', id: '31_soc_3', group: '사과' },
                        { name: '사회문제 탐구', id: '31_soc_4', group: '사과' },
                        { name: '역사로 탐구하는 현대 세계', id: '31_soc_5', group: '사과' },
                    ],
                    '과학': [
                        { name: '전자기와 양자', id: '31_sci_1', group: '사과' },
                        { name: '화학 반응의 세계', id: '31_sci_2', group: '사과' },
                        { name: '생물의 유전', id: '31_sci_3', group: '사과' },
                        { name: '행성우주과학', id: '31_sci_4', group: '사과' },
                        { name: '기후변화와 환경생태', id: '31_sci_5', group: '사과' },
                    ],
                    '기술·가정/정보': [
                        { name: '지식 재산 일반', id: '31_tech_1', group: '기정제' },
                        { name: '인공지능 기초', id: '31_tech_2', group: '기정제' },
                    ],
                    '제2외국어/한문': [
                        { name: '스페인어권 문화', id: '31_lang_1', group: '기정제' },
                        { name: '일본 문화', id: '31_lang_2', group: '기정제' },
                    ],
                    '예술': [
                        { name: '음악과 미디어', id: '31_art_1', group: '예술' },
                        { name: '미술과 매체', id: '31_art_2', group: '예술' },
                    ]
                }
            },
            '3-2': {
                limit: 9,
                courses: {
                     '국어': [
                        { name: '매체 의사소통', id: '32_kor_1', group: '국수영' },
                        { name: '언어생활 탐구', id: '32_kor_2', group: '국수영' }
                    ],
                    '수학': [
                        { name: '수학과 문화', id: '32_math_1', group: '국수영' },
                        { name: '실용 통계', id: '32_math_2', group: '국수영' },
                    ],
                    '영어': [
                        { name: '심화 영어 독해와 작문', id: '32_eng_1', group: '국수영' },
                        { name: '미디어 영어', id: '32_eng_2', group: '국수영' },
                    ],
                     '사회': [
                        { name: '국제 관계의 이해', id: '32_soc_1', group: '사과' },
                        { name: '인문학과 윤리', id: '32_soc_2', group: '사과' },
                        { name: '도시의 미래 탐구', id: '32_soc_3', group: '사과' },
                        { name: '여행지리', id: '32_soc_4', group: '사과' },
                    ],
                    '과학': [
                        { name: '과학의 역사와 문화', id: '32_sci_1', group: '사과' },
                    ],
                    '기술·가정/정보': [
                        { name: '창의 공학 설계', id: '32_tech_1', group: '기정제' },
                        { name: '소프트웨어와 생활', id: '32_tech_2', group: '기정제' },
                    ],
                    '제2외국어/한문': [
                        { name: '심화 스페인어', id: '32_lang_1', group: '기정제' },
                        { name: '심화 일본어', id: '32_lang_2', group: '기정제' },
                    ],
                    '예술': [
                        { name: '음악콘텐츠 제작', id: '32_art_1', group: '예술' },
                        { name: '조형', id: '32_art_2', group: '예술' },
                    ]
                }
            }
        };

        const courseImageData = [
            {"과목명":"경제","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/경제.jpg"},
            {"과목명":"과학의 역사와 문화","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/과학의_역사와_문화.jpg"},
            {"과목명":"국제 관계의 이해","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/국제_관계의_이해.jpg"},
            {"과목명":"금융과 경제생활","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/금융과_경제생활.jpg"},
            {"과목명":"기술·가정","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/기술·가정.jpg"},
            {"과목명":"기하","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/기하.jpg"},
            {"과목명":"기후변화와 지속가능한 세계","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/기후변화와_지속가능한_세계.jpg"},
            {"과목명":"기후변화와 환경생태","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/기후변화와_환경생태.jpg"},
            {"과목명":"대수","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/대수.jpg"},
            {"과목명":"데이터 과학","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/데이터_과학.jpg"},
            {"과목명":"도시의 미래 탐구","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/도시의_미래_탐구.jpg"},
            {"과목명":"독서 토론과 글쓰기","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/독서_토론과_글쓰기.jpg"},
            {"과목명":"독서와 작문","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/독서와_작문.jpg"},
            {"과목명":"동아시아 역사 기행","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/동아시아_역사_기행.jpg"},
            {"과목명":"매체 의사소통","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/매체_의사소통.jpg"},
            {"과목명":"문학","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/문학.jpg"},
            {"과목명":"문학과 영상","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/문학과_영상.jpg"},
            {"과목명":"물리와 화학","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/물리와_화학.jpg"},
            {"과목명":"물질과 에너지","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/물질과 에너지.jpg"},
            {"과목명":"미디어 영어","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/미디어_영어.jpg"},
            {"과목명":"미술","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/미술.jpg"},
            {"과목명":"미술 감상과 비평","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/미술_감상과_비평.jpg"},
            {"과목명":"미술 창작","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/미술_창작.jpg"},
            {"과목명":"미술과 매체","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/미술과_매체.jpg"},
            {"과목명":"미적분1","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/미적분1.jpg"},
            {"과목명":"미적분Ⅱ","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/미적분2.jpg"},
            {"과목명":"법과 사회","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/법과_사회.jpg"},
            {"과목명":"사회문제 탐구","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/사회문제_탐구.jpg"},
            {"과목명":"사회와 문화","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/사회와_문화.jpg"},
            {"과목명":"생명과학","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/생명과학.jpg"},
            {"과목명":"생물의 유전","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/생물의_유전.jpg"},
            {"과목명":"생활과학 탐구","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/생활과학_탐구.jpg"},
            {"과목명":"세계 문화와 영어","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/세계_문화와_영어.jpg"},
            {"과목명":"세계시민과 지리","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/세계_시민과_지리.jpg"},
            {"과목명":"세계사","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/세계사.jpg"},
            {"과목명":"세포와 물질대사","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/세포와_물질대사.jpg"},
            {"과목명":"소프트웨어와 생활","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/소프트웨어와_생활.jpg"},
            {"과목명":"수학과 문화","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/수학과_문화.jpg"},
            {"과목명":"수학과제 탐구","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/수학과제_탐구.jpg"},
            {"과목명":"스페인어","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/스페인어.jpg"},
            {"과목명":"스페인어 회화","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/스페인어_회화.jpg"},
            {"과목명":"스페인어권 문화","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/스페인어권_문화.jpg"},
            {"과목명":"스포츠 과학","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/스포츠_과학.jpg"},
            {"과목명":"스포츠 문화","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/스포츠_문화.jpg"},
            {"과목명":"스포츠 생활 1","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/스포츠_생활1.jpg"},
            {"과목명":"스포츠 생활 2","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/스포츠_생활2.jpg"},
            {"과목명":"실용 통계","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/실용_통계.jpg"},
            {"과목명":"심화 스페인어","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/심화_스페인어.jpg"},
            {"과목명":"심화 영어","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/심화_영어.jpg"},
            {"과목명":"심화 영어 독해와 작문","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/심화_영어_독해와_작문.jpg"},
            {"과목명":"심화 일본어","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/심화_일본어.jpg"},
            {"과목명":"아동발달과 부모","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/아동발달과_부모.jpg"},
            {"과목명":"언어생활 탐구","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/언어생활_탐구.jpg"},
            {"과목명":"여행지리","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/여행지리.jpg"},
            {"과목명":"역사로 탐구하는 현대 세계","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/역사로_탐구하는_현대_세계.jpg"},
            {"과목명":"역학과 에너지","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/역학과_에너지.jpg"},
            {"과목명":"영미 문학 읽기","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/영미_문학_읽기.jpg"},
            {"과목명":"영어 독해와 작문","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/영어_독해와_작문.jpg"},
            {"과목명":"영어1","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/영어1.jpg"},
            {"과목명":"영어2","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/영어2.jpg"},
            {"과목명":"윤리문제 탐구","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/윤리문제_탐구.jpg"},
            {"과목명":"윤리와 사상","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/윤리와_사상.jpg"},
            {"과목명":"융합과학 탐구","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/융합과학_탐구.jpg"},
            {"과목명":"음악","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/음악.jpg"},
            {"과목명":"음악 감상과 비평","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/음악_감상과_비평.jpg"},
            {"과목명":"음악 연주와 창작","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/음악_연주와_창작.jpg"},
            {"과목명":"음악과 미디어","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/음악과_미디어.jpg"},
            {"과목명":"인공지능 기초","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/인공지능_기초.jpg"},
            {"과목명":"인공지능 수학","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/인공지능_수학.jpg"},
            {"과목명":"인문학과 윤리","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/인문학과_윤리.jpg"},
            {"과목명":"일본어 회화","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/일본어_회화.jpg"},
            {"과목명":"일본어","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/일본어.jpg"},
            {"과목명":"일본 문화","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/일본_문화.jpg"},
            {"과목명":"전자기와 양자","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/전자기와_양자.jpg"},
            {"과목명":"정보","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/정보.jpg"},
            {"과목명":"정치","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/정치.jpg"},
            {"과목명":"주제 탐구 독서","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/주제_탐구_독서.jpg"},
            {"과목명":"지구과학","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/지구과학.jpg"},
            {"과목명":"지구시스템과학","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/지구시스템과학.jpg"},
            {"과목명":"지식 재산 일반","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/지식_재산_일반.jpg"},
            {"과목명":"창의 공학 설계","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/창의_공학_설계.jpg"},
            {"과목명":"체육1","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/체육1.jpg"},
            {"과목명":"체육2","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/체육2.jpg"},
            {"과목명":"한국지리 탐구","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/한국지리_탐구.jpg"},
            {"과목명":"행성우주과학","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/행성우주과학.jpg"},
            {"과목명":"현대사회와 윤리","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/현대사회와_윤리.jpg"},
            {"과목명":"화법과 언어","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/화법과_언어.jpg"},
            {"과목명":"화학","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/화학.jpg"},
            {"과목명":"화학 반응의 세계","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/화학_반응의_세계.jpg"},
            {"과목명":"확률과 통계","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/확률과_통계.jpg"},
            {"과목명":"물리학","이미지_링크":"https://kgghs.github.io/kyunggi-guide2025/images/courses/물리학.jpg"}
        ];
        
        const courseGrid = document.getElementById('course-grid');
        const socialStudiesContainer = document.getElementById('social-studies-container');
        const scienceContainer = document.getElementById('science-container');
        const groupedCoursesContainer = document.getElementById('grouped-courses-container');
        const filterContainer = document.getElementById('filter-container');
        const modal = document.getElementById('course-modal');
        const modalTitle = document.getElementById('modal-title');
        const closeModalBtn = document.getElementById('close-course-modal-btn');
        const pdfModal = document.getElementById('pdf-viewer-modal');
        const openPdfBtn = document.getElementById('open-curriculum-pdf');
        const closePdfBtn = document.getElementById('close-pdf-modal-btn');
        const pdfIframe = document.getElementById('pdf-iframe');
        
        // 데이터 병합 로직
        const imageLinkMap = new Map(courseImageData.map(item => [item.과목명, item.이미지_링크]));

        for (const subject in originalCourses) {
            const courses = originalCourses[subject];
            if (Array.isArray(courses)) {
                courses.forEach(course => {
                    const imageUrl = imageLinkMap.get(course.name);
                    if (imageUrl) {
                        course.imageUrl = imageUrl;
                    }
                });
            } else { 
                for (const area in courses) {
                    courses[area].forEach(course => {
                         const imageUrl = imageLinkMap.get(course.name);
                         if (imageUrl) {
                            course.imageUrl = imageUrl;
                        }
                    });
                }
            }
        }


        const getTypeClass = (type) => {
            let style = 'subject-type-badge ';
            switch(type) {
                case '공통과목': return style + 'bg-gray-200 text-gray-800';
                case '일반선택': return style + 'bg-sky-100 text-sky-800';
                case '진로선택': return style + 'bg-emerald-100 text-emerald-800';
                case '융합선택': return style + 'bg-amber-100 text-amber-800';
                default: return style + 'bg-gray-100 text-gray-800';
            }
        };
        
        const openModal = (course) => {
            const modalContent = document.getElementById('modal-content');

            if (!course || !modal || !modalTitle || !modalContent) return;

            modalTitle.textContent = `${course.name} 상세 정보`;
            modalContent.innerHTML = ''; // Clear previous content

            if (course.imageUrl) {
                const img = document.createElement('img');
                img.src = course.imageUrl;
                img.alt = `${course.name} 상세 정보`;
                img.className = "w-full h-auto rounded-lg";
                modalContent.appendChild(img);
            } else if (course.name === '조형' || course.name === '음악콘텐츠 제작' || (course.name === '정보과학(특목)' && course.description)) {
                 modalContent.innerHTML = `<div class="p-4 text-left text-gray-700">${course.description.replace(/</g, "&lt;").replace(/>/g, "&gt;")}</div>`;
            }
            else {
                modalContent.innerHTML = `<p class="p-4 text-center text-gray-600">이 과목의 상세 소개 이미지가 아직 준비되지 않았습니다.</p>`;
            }
            
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        };

        const closeModal = (modalElement) => {
            if(!modalElement) return;
            modalElement.classList.add('hidden');
            document.body.style.overflow = '';
        };

        const createCourseCard = (course) => {
            const card = document.createElement('div');
            card.setAttribute('data-course-name', course.name);
            let cardText = '상세 정보를 보려면 클릭하세요';
            let cardClasses = 'card bg-white p-6 rounded-lg shadow-sm flex flex-col border-l-4 border-gray-300';
           
            if (!course.imageUrl) {
                 if(course.name === '조형' || course.name === '음악콘텐츠 제작' || course.name === '정보과학(특목)'){
                     cardText = '상세정보 보기';
                 } else {
                     cardText = '상세 정보(이미지) 없음';
                 }
            }
            
            card.className = cardClasses;
            card.innerHTML = `
            <div class="flex-grow">
                <div class="flex justify-between items-start mb-3">
                    <h3 class="text-xl font-bold text-gray-800">${course.name}</h3>
                    <span class="text-xs font-semibold px-2 py-1 rounded-full ${getTypeClass(course.type).replace('subject-type-badge ', '')}">${course.type}</span>
                </div>
                <p class="text-sm text-gray-500 mb-4">개설 학기: ${course.grade}</p>
                <p class="text-gray-600 leading-relaxed text-sm">${cardText}</p>
            </div>`;
            return card;
        };


        const renderDomainCourses = (container, data, areaOrder, areaColors, notice) => {
            let content = notice ? `<div class="notice-box col-span-1 md:col-span-2 lg:col-span-4"><p class="font-bold">${notice.main}</p><p class="text-sm text-yellow-800 mt-2">${notice.sub}</p></div>` : '';
            content += '<div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-8">';
            areaOrder.forEach(area => {
                content += `<div class="domain-area-container border-t-4 ${areaColors[area]}">`;
                content += `<h3 class="text-2xl font-bold text-center mb-6 text-gray-800">${area} 영역</h3>`;
                const typeOrder = ['공통과목', '일반선택', '진로선택', '융합선택'];
                typeOrder.forEach(type => {
                    const coursesOfType = data[area].filter(c => c.type !== '공통과목');
                    coursesOfType.sort((a,b) => (a.grade || 'Z').localeCompare(b.grade || 'Z'));
                    if (coursesOfType.length > 0) {
                        content += `<div class="mb-4">`;
                        content += `<span class="${getTypeClass(type)}">${type}</span>`;
                        content += '<div class="space-y-2 mt-2">';
                        coursesOfType.forEach(course => {
                            const card = createCourseCard(course);
                            content += card.outerHTML;
                        });
                        content += '</div></div>';
                    }
                });
                content += '</div>';
            });
            content += '</div>';
            container.innerHTML = content;
        };
        
        const renderGroupedCourses = (container, data, areaColors, notice) => {
            let content = notice ? `<div class="col-span-1 md:col-span-2 notice-box"><p class="font-bold">${notice.main}</p></div>` : '';
            content += `<div class="grid grid-cols-1 md:grid-cols-2 gap-8">`;
            for(const area in data) {
                 content += `<div class="grouped-area-container border-t-4 ${areaColors[area]}">`;
                 content += `<h3 class="text-2xl font-bold text-center mb-6 text-gray-800">${area}</h3>`;
                 content += '<div class="space-y-4">';
                 data[area].forEach(course => {
                     const card = createCourseCard(course);
                     content += card.outerHTML;
                 });
                 content += '</div></div>';
            }
            content += `</div>`;
            container.innerHTML = content;
        };

        const renderSocialStudies = () => {
            const socialData = originalCourses['사회'];
            const areaOrder = ['지리', '일반사회', '역사', '윤리'];
            const areaColors = {
                '지리': 'border-green-500', '일반사회': 'border-blue-500', '역사': 'border-red-500', '윤리': 'border-purple-500',
            };
            const notice = {
                main: '사회교과(군)에서는 2,3학년 동안 자유로운 과목선택이 가능합니다.',
                sub: '(1학년 공통과목으로 필수이수학점을 모두 충족함)'
            };
             renderDomainCourses(socialStudiesContainer, socialData, areaOrder, areaColors, notice);
        };

        const renderScience = () => {
            const scienceData = originalCourses['과학'];
            const areaOrder = ['물리학', '화학', '생명과학', '지구과학', '융합'];
            const areaColors = {
                '물리학': 'border-orange-500', '화학': 'border-cyan-500', '생명과학': 'border-lime-500', '지구과학': 'border-indigo-500', '융합': 'border-teal-500'
            };
             const notice = {
                main: '과학교과(군)에서는 2,3학년 동안 자유로운 과목선택이 가능합니다.',
                sub: '(1학년 공통과목으로 필수이수학점을 모두 충족함)'
            };
             renderDomainCourses(scienceContainer, scienceData, areaOrder, areaColors, notice);
        };
        
        const displayCourses = (filter) => {
            courseGrid.classList.add('hidden');
            socialStudiesContainer.classList.add('hidden');
            scienceContainer.classList.add('hidden');
            groupedCoursesContainer.classList.add('hidden');

            const groupedSubjects = ['기술·가정/정보', '제2외국어/한문', '예술'];
            const domainSubjects = ['사회', '과학'];

            if (domainSubjects.includes(filter)) {
                if (filter === '사회') {
                    socialStudiesContainer.classList.remove('hidden');
                    renderSocialStudies();
                } else {
                    scienceContainer.classList.remove('hidden');
                    renderScience();
                }
            } else if (groupedSubjects.includes(filter)) {
                groupedCoursesContainer.classList.remove('hidden');
                const data = originalCourses[filter];
                const colors = {
                    '기술가정 계열': 'border-pink-500', '정보 계열': 'border-gray-500',
                    '스페인어': 'border-yellow-500', '일본어': 'border-red-400',
                    '음악': 'border-blue-400', '미술': 'border-purple-400',
                };
                let notice = null;
                if (filter === '기술·가정/정보' || filter === '제2외국어/한문') {
                    notice = { main: '필수이수학점 충족을 위해 2,3학년동안 기술·가정/정보 및 제2외국어 교과(군)에서 총 4과목 이상 수강해야 합니다.' };
                } else if (filter === '예술') {
                    notice = { main: '필수이수학점 충족을 위해 2,3학년동안 예술 교과(군)에서 2과목 이상 수강해야 합니다.' };
                }
                renderGroupedCourses(groupedCoursesContainer, data, colors, notice);
            } else {
                courseGrid.classList.remove('hidden');
                let gridContent = '';
                
                if (['국어', '수학', '영어'].includes(filter)) {
                    gridContent += `<div class="col-span-1 md:col-span-2 lg:col-span-3 notice-box"><p class="font-bold">국어,수학,영어 교과(군)에서는 2,3학년동안 총 8과목 이내의 선택과목 수강이 가능합니다.</p><p class="text-sm text-yellow-800 mt-2">(학교지정과목으로 필수이수학점이 모두 충족되며, 국어-수학-영어과목의 총 이수학점이 81학점을 초과할 수 없음)</p></div>`;
                }


                if (filter === '체육') {
                    const noteHTML = `<div class="col-span-1 md:col-span-2 lg:col-span-3 notice-box"><p class="font-bold">안내: 체육은 학교 지정과목으로 매학기 개설됩니다 (선택과목이 아닙니다).</p></div>`;
                    gridContent += noteHTML;
                }
                
                let coursesToDisplay = [];

                if (filter === '전체') {
                    const allCourses = [];
                    Object.entries(originalCourses).forEach(([subject, data]) => {
                        let coursesToAdd = Array.isArray(data) ? data : Object.values(data).flat();
                        coursesToAdd.forEach(course => {
                            if (course.type !== '공통과목') {
                                const displaySubject = course.name === '한국사' ? '한국사' : subject;
                                allCourses.push({ ...course, displaySubject: displaySubject });
                            }
                        });
                    });
                    const uniqueCourses = Array.from(new Map(allCourses.map(c => [c.name, c])).values());
                    const subjectOrder = ['국어', '수학', '영어', '사회', '과학', '한국사', '기술·가정/정보', '제2외국어/한문', '예술', '체육'];
                    uniqueCourses.sort((a, b) => {
                        const indexA = subjectOrder.indexOf(a.displaySubject);
                        const indexB = subjectOrder.indexOf(b.displaySubject);
                        if (indexA !== indexB) {
                            return (indexA === -1 ? Infinity : indexA) - (indexB === -1 ? Infinity : indexB);
                        }
                        return (a.grade || 'Z').localeCompare(b.grade || 'Z');
                    });
                    coursesToDisplay = uniqueCourses;
                } else {
                    coursesToDisplay = Array.isArray(originalCourses[filter]) ? originalCourses[filter] : [];
                    coursesToDisplay.sort((a, b) => (a.grade || 'Z').localeCompare(b.grade || 'Z'));
                }
                
                if (coursesToDisplay.length === 0 && !domainSubjects.includes(filter) && !groupedSubjects.includes(filter)) {
                    gridContent += `<p class="text-center text-gray-500 col-span-full">선택된 교과군의 과목이 없습니다.</p>`;
                }

                coursesToDisplay.forEach(course => {
                    const card = createCourseCard(course);
                    gridContent += card.outerHTML;
                });
                courseGrid.innerHTML = gridContent;
            }
        };

        // Event Listeners
        filterContainer.addEventListener('click', (e) => {
            if (e.target.tagName === 'BUTTON') {
                currentFilter = e.target.dataset.filter;
                document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active-filter'));
                e.target.classList.add('active-filter');
                displayCourses(currentFilter);
            }
        });

        document.body.addEventListener('click', (e) => {
            const card = e.target.closest('[data-course-name]');
            if (card) {
                const courseName = card.dataset.courseName;
                let foundCourse = null;

                Object.values(originalCourses).forEach(subject => {
                    if (foundCourse) return;
                    if(Array.isArray(subject)) {
                        const course = subject.find(c => c.name === courseName);
                        if(course) foundCourse = course;
                    } else {
                         Object.values(subject).forEach(area => {
                            if (foundCourse) return;
                            const course = area.find(c => c.name === courseName);
                            if(course) foundCourse = course;
                         });
                    }
                });

                if (foundCourse) {
                    openModal(foundCourse);
                }
            }
        });
        
        if (closeModalBtn) {
            closeModalBtn.addEventListener('click', () => closeModal(modal));
        }
        if(modal){
             modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeModal(modal);
                }
            });
        }
       
        if(openPdfBtn) {
            openPdfBtn.addEventListener('click', (e) => {
                e.preventDefault();
                const pdfUrl = 'https://kgghs.github.io/kyunggi-guide2025/2025%ED%95%99%EB%85%84%EB%8F%84%20%EC%9E%85%ED%95%99%EC%83%9D%20%EA%B5%90%EC%9C%A1%EA%B3%BC%EC%A0%95%20%EC%84%A0%ED%83%9D%20%EA%B0%80%EC%9D%B4%EB%93%9C%EB%B6%81.pdf';
                if(pdfIframe) pdfIframe.src = pdfUrl;
                if(pdfModal) pdfModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            });
        }

        if(closePdfBtn) {
            closePdfBtn.addEventListener('click', () => closeModal(pdfModal));
        }
        if(pdfModal){
             pdfModal.addEventListener('click', (e) => {
                if (e.target === pdfModal) {
                    closeModal(pdfModal);
                }
            });
        }
        
        // Initial Load
        document.querySelector('.filter-btn[data-filter="전체"]').classList.add('active-filter');
        displayCourses('전체');

        // Timetable Builder Logic
        const timetableBuilder = document.getElementById('timetable-builder');
        if(timetableBuilder){
            const selectionPanel = document.getElementById('selection-panel');
            
            const renderTimetable = () => {
                let html = '';
                for (const semester in timetableData) {
                    const semesterInfo = timetableData[semester];
                    html += `<div class="p-4 bg-white rounded-lg shadow-sm">
                                <h4 class="font-bold text-lg mb-1">${semester.replace('-', '학년 ')}학기 <span class="font-normal text-sm text-red-500">(${semesterInfo.limit}개 선택)</span></h4>`;
                    const designatedCourses = {
                        '2-1': ['문학', '대수', '영어Ⅰ', '스포츠생활1'],
                        '2-2': ['독서와 작문', '미적분', '영어Ⅱ', '스포츠생활2'],
                        '3-1': ['화법과 언어', '확률과 통계', '영어독해와 작문', '스포츠 문화'],
                        '3-2': ['스포츠 과학']
                    };
                    if(designatedCourses[semester]) {
                        html += `<div class="text-xs text-gray-500 mb-3">
                                    <span class="font-semibold">학교지정과목:</span> ${designatedCourses[semester].join(', ')}
                                 </div>`;
                    }
                    html += `<div class="space-y-4">`;
                    for(const subjectGroup in semesterInfo.courses) {
                        html += `<div><p class="font-semibold text-sm text-gray-600 mb-1">${subjectGroup}</p><div class="space-y-1">`;
                        semesterInfo.courses[subjectGroup].forEach(course => {
                            let groupClass = '';
                            if (course.group === '국수영') groupClass = 'kme-group';
                            else if (course.group === '기정제') groupClass = 'tech-group';
                            else if (course.group === '예술') groupClass = 'art-group';
                            
                            html += `<label for="${course.id}" class="flex items-center cursor-pointer">
                                        <input type="checkbox" id="${course.id}" name="${semester}" data-group="${course.group}" class="timetable-checkbox ${groupClass}">
                                        <span class="custom-checkbox"></span>
                                        <span class="ml-2 block text-sm text-gray-900">${course.name}</span>
                                    </label>`;
                        });
                        html += `</div></div>`;
                    }
                    html += '</div></div>';
                }
                selectionPanel.innerHTML = html;
                selectionPanel.addEventListener('change', handleCheckboxChange);
            }

            const handleCheckboxChange = () => {
                const allCheckboxes = Array.from(selectionPanel.querySelectorAll('.timetable-checkbox'));
                
                // 1. Calculate counts for groups and semesters
                const checkedGroups = { '국수영': [], '기정제': [], '예술': [], '사과': [] };
                const checkedSemesters = {};
                for (const semester in timetableData) {
                    checkedSemesters[semester] = [];
                }

                allCheckboxes.forEach(box => {
                    if (box.checked) {
                        const group = box.dataset.group;
                        const semester = box.name;
                        if (checkedGroups[group]) checkedGroups[group].push(box);
                        if (checkedSemesters[semester]) checkedSemesters[semester].push(box);
                    }
                });

                // 2. Update numbering based on group counts
                allCheckboxes.forEach(box => {
                    box.nextElementSibling.textContent = ''; // Reset all numbers
                });
                Object.values(checkedGroups).forEach(groupArray => {
                    groupArray.forEach((box, index) => {
                        box.nextElementSibling.textContent = index + 1;
                    });
                });

                // 3. Apply disabling logic
                const kmeLimit = 8;
                const kmeCount = checkedGroups['국수영'].length;

                allCheckboxes.forEach(box => {
                    // A checked box should always be enabled to allow unchecking
                    if (box.checked) {
                        box.disabled = false;
                        return;
                    }

                    let isDisabled = false;

                    // Condition 1: Check semester limit
                    const semester = box.name;
                    const semesterLimit = timetableData[semester].limit;
                    const semesterCount = checkedSemesters[semester].length;
                    if (semesterCount >= semesterLimit) {
                        isDisabled = true;
                    }

                    // Condition 2: Check KME group limit
                    const group = box.dataset.group;
                    if (!isDisabled && group === '국수영' && kmeCount >= kmeLimit) {
                        isDisabled = true;
                    }
                    
                    box.disabled = isDisabled;
                });
            }

            renderTimetable();
        }
    });
    </script>
</body>
</html>
